DATA SEGMENT
    CHAR_X DW 4
    CHAR_Y DW 54
    CHAR_SIZE DW 10
    STRING DB "STEP: ","$"
    SCORE_0 DB '0'
    SCORE_1 DB '0'
    SCORE_2 DB '0'
    MIN_SCORE DB "MIN STEP:","$"
    LV DB "LV:","$"
    bool db 0
ENDS
STACK SEGMENT
    DW 128 DUP(0)   ;initializes stack
ENDS

CODE SEGMENT
    START:
    MAIN PROC
    MOV AX,DATA
    MOV DS,AX
    MOV ES,AX

MOV AH,00H;SET VIDEO MODE
MOV AL,12H;RESOLUTION 320x200
INT 10H
CALL SHOW_SCORE
CALL SHOW_MINSCORE
CALL SHOW_LEVEL
MOV AL,0DH ;MAGENTA
MOV AH,0CH ;WRITE PIXEL

MOV DX,50
MOV CX,0 
;INT 10H
L1V1:
INC DX
INT 10H
CMP DX,350
JB L1V1

MOV DX,50
MOV CX,300
L1V2:
INC DX
INT 10H
CMP DX,350
JB L1V2

MOV DX,50
MOV CX,0
L1H1:
INC CX 
INT 10H
CMP CX,300
JB L1H1


MOV DX,350
MOV CX,0
L1H3:
INC CX 
INT 10H
CMP CX,150
JB L1H3

MOV DX,350
MOV CX,180
L1H4:
INC CX 
INT 10H
CMP CX,300
JB L1H4

MOV DX,110
MOV CX,0
L1H5:
INC CX
INT 10H
CMP CX,30
JB L1H5

MOV DX,260
MOV CX,0
L1H6:
INC CX 
INT 10H
CMP CX,60
JB L1H6

MOV DX,320
MOV CX,0
L1H7:
INC CX
INT 10H
CMP CX,30
JB L1H7

MOV DX,320
MOV CX,30
L1V3:
DEC DX
INT 10H
CMP DX,290
JA L1V3

MOV DX,170
MOV CX,30
L1V4:
INC DX 
INT 10H
CMP DX,230
JB L1V4

MOV DX,80
MOV CX,30
L1H8:
INC CX 
INT 10H
CMP CX,60
JB L1H8

MOV DX,80
MOV CX,60
L1V5:
INC DX
INT 10H
CMP DX,110
JB L1V5

MOV DX,110
MOV CX,60
L1H9:
INC CX
INT 10H
CMP CX,210
JB L1H9

MOV DX,140
MOV CX,30
L1H10:
INC CX
INT 10H
CMP CX,90
JB L1H10

MOV DX,200
MOV CX,30
L1H11:
INC CX
INT 10H
CMP CX,90
JB L1H11

MOV DX,230
MOV CX,30
L1H12:
INC CX
INT 10H
CMP CX,120
JB L1H12

MOV DX,350
MOV CX,60
L1V6:
DEC DX
INT 10H
CMP DX,320
JA L1V6

MOV DX,80
MOV CX,90
L1V7:
INC DX 
INT 10H
CMP DX,170
JB L1V7

MOV DX,170
MOV CX,60
L1H13:
INC CX
INT 10H
CMP CX,120
JB L1H13

MOV DX,170
MOV CX,120
L1V8:
INC DX
INT 10H
CMP DX,230
JB L1V8

MOV DX,230
MOV CX,90
L1V9:
INC DX
INT 10H 
CMP DX,260
JB L1V9

MOV DX,290
MOV CX,60
L1H14:
INC CX
INT 10H
CMP CX,120
JB L1H14

MOV DX,290
MOV CX,90
L1V10:
INC DX
INT 10H
CMP DX,320
JB L1V10

MOV DX,50
MOV CX,120
L1V11:
INC DX
INT 10H
CMP DX,80
JB L1V11

MOV DX,110
MOV CX,120
L1V12:
INC DX
INT 10H
CMP DX,140
JB L1V12

MOV DX,140
MOV CX,120
L1H15:
INC CX
INT 10H
CMP CX,150
JB L1H15

MOV DX,140
MOV CX,150
L1V13:
INC DX
INT 10H
CMP DX,260
JB L1V13

MOV DX,260
MOV CX,150
L1H16:
DEC CX
INT 10H
CMP CX,120
JA L1H16 

MOV DX,260
MOV CX,120
L1V14:
INC DX
INT 10H
CMP DX,350
JB L1V14

MOV DX,80
MOV CX,150
L1V15:
INC DX
INT 10H
CMP DX,110
JB L1V15

MOV DX,80
MOV CX,150
L1H17:
INC CX
INT 10H
CMP CX,180
JB L1H17

MOV DX,80
MOV CX,210
L1V16:
INC DX
INT 10H
CMP DX,110  
JB L1V16

MOV DX,110
MOV CX,180
L1V17:
INC DX
INT 10H
CMP DX,170
JB L1V17

MOV DX,200
MOV CX,150
L1H18:
INC CX
INT 10H
CMP CX,210
JB L1H18

MOV DX,140
MOV CX,180
L1H19:
INC CX
INT 10H
CMP CX,240
JB L1H19

MOV DX,80
MOV CX,240 
L1H20:
INC CX
INT 10H 
CMP CX,270
JB L1H20

MOV DX,80
MOV CX,270
L1V18:
INC DX
INT 10H
CMP DX,110
JB L1V18

MOV DX,110
MOV CX,270
L1H21:
DEC CX
INT 10H
CMP CX,240
JA L1H21

MOV DX,110
MOV CX,240
L1V19:
INC DX
INT 10H
CMP DX,230
JB L1V19

MOV DX,170
MOV CX,210
L1H22:
INC CX
INT 10H
CMP CX,240
JB L1H22

MOV DX,200
MOV CX,240
L1H23:
INC CX
INT 10H
CMP CX,270
JB L1H23

MOV DX,200
MOV CX,270
L1V20:
INC DX
INT 10H
CMP DX,320
JB L1V20

MOV DX,320
MOV CX,270
L1H24:
DEC CX
INT 10H
CMP CX,240
JA L1H24

MOV DX,350
MOV CX,180
L1V21:
DEC DX
INT 10H
CMP DX,320
JA L1V21

MOV DX,320
MOV CX,180
L1H25:
DEC CX
INT 10H
CMP CX,150
JB L1H25

MOV DX,320
MOV CX,150
L1V22:
DEC DX
INT 10H
CMP DX,290
JA L1V22

MOV DX,290
MOV CX,150
L1H26:
INC CX
INT 10H
CMP CX,180
JB L1H26

MOV DX,290
MOV CX,180
L1V23:
DEC DX
INT 10H
CMP DX,230
JA L1V23

MOV DX,230
MOV CX,180
L1H27:
INC CX
INT 10H
CMP CX,210
JB L1H27

MOV DX,230
MOV CX,210
L1V24:
INC DX
INT 10H
CMP DX,260
JB L1V24

MOV DX,260
MOV CX,210
L1H28:
INC CX
INT 10H
CMP CX,240
JB L1H28

MOV DX,290
MOV CX,210
L1V25:
INC DX
INT 10H
CMP DX,350
JB L1V25

     
CALL DRAW_CHAR

CALL INPUT

ret
     
MAIN ENDP  
;-------------------------------------------------- 

    DRAW_CHAR PROC
    MOV CX,CHAR_X
    MOV DX,CHAR_Y
    MOV AH,0CH ;write a pixel
    MOV AL,0FH ;white colour
    DRAW:
    INT 10H
    INC CX
    MOV BX,CX
    SUB BX,CHAR_X
    CMP BX,CHAR_SIZE
    JNG DRAW
    MOV CX,CHAR_X
    INC DX
    MOV BX,DX
    SUB BX,CHAR_Y
    CMP BX,CHAR_SIZE
    JNG DRAW
    RET    
    DRAW_CHAR ENDP

;--------------------------------------------------
INPUT PROC
    INP:
        MOV AH,00H
        INT 16H
        CMP AH,48H ;IF ARROW UP IS PRESSSED
        JE UP
        CMP AH,50H ;DOWN KEY
        JE DOWN
        CMP AH,4BH ;LEFT
        JE LEFT
        CMP AH,4DH ;RIGHT
        JE RIGHT
        CMP AL,1BH ;ESCAPE
        JE ESCAPE
        JMP INP
    RIGHT:
        MOV CX,CHAR_X;COLUMN NUMBER
        ADD CX,16
        MOV DX,CHAR_Y
        ADD DX,4  
        CMP CX,300
        JA LV1COMPLETE
        CALL CHECK 
        CMP BOOL,1  
        JE EXIT
        CALL CALC_SCORE
        CALL DELETE_CHAR
        MOV CX,CHAR_X
        ADD CX,10
        MOV CHAR_X,CX
        CALL DRAW_CHAR
        JMP INP
    UP:
        MOV CX,CHAR_X
        MOV DX,CHAR_Y
        SUB DX,4
        CALL CHECK 
        CMP BOOL,1  
        JE EXIT 
        CALL CALC_SCORE
        CALL DELETE_CHAR
        SUB CHAR_Y,10
        CALL DRAW_CHAR
        JMP INP
    LEFT:
        MOV CX,CHAR_X
        SUB CX,4
        MOV DX,CHAR_Y
        ADD DX,4
        CALL CHECK 
        CMP BOOL,1  
        JE EXIT 
        CALL CALC_SCORE
        CALL DELETE_CHAR
        SUB CHAR_X,10
        CALL DRAW_CHAR
        JMP INP
    DOWN:
        MOV CX,CHAR_X
        ADD CX,5
        MOV DX,CHAR_Y
        ADD DX,16
        CALL CHECK 
        CMP BOOL,1  
        JE EXIT 
        CALL CALC_SCORE
        CALL DELETE_CHAR
        ADD CHAR_Y,10
        CALL DRAW_CHAR
        JMP INP
    ESCAPE:
        MOV AH,00H
        MOV AL,12H
        INT 10H
    EXIT:
        MOV AH,02H
        MOV DL,07H ;beep sound
        INT 21H 
        MOV BOOL,0
        JMP INP
    LV1COMPLETE:
        MOV AH,00H
        MOV AL,12H
        INT 10H
INPUT ENDP

;-------------------------------------------------
DELETE_CHAR PROC
    MOV CX,CHAR_X
    MOV DX,CHAR_Y
    MOV AH,0CH
    MOV AL,00H;black colour
    DELETE:
    INT 10H
    INC CX
    MOV BX,CX
    SUB BX,CHAR_X
    CMP BX,CHAR_SIZE
    JNG DELETE
    MOV CX,CHAR_X
    INC DX
    MOV BX,DX
    SUB BX,CHAR_Y
    CMP BX,CHAR_SIZE
    JNG DELETE
    RET
DELETE_CHAR ENDP

;--------------------------------------------------------------------

SHOW_SCORE PROC
    MOV DL,1;column
    MOV DH,1;row
    MOV AH,02  ;setting cursor position
    INT 10H
LEA DX,STRING 
  
 ;output the string
 ;loaded in dx 
 MOV AH,09H
 INT 21H
 MOV DL,8 ;for 000
 MOV DH,1
 MOV AH,02
 INT 10H
 MOV AL, SCORE_0
 MOV BL, 0Ch  ;Color is orange
 MOV BH, 0    ;Display page
 MOV AH, 0Eh  ;Teletype
 INT 10H
 MOV AL,SCORE_1
 INT 10H
 MOV AL,SCORE_2
 INT 10H
    RET
SHOW_SCORE ENDP
;--------------------------------------------------------------------
SHOW_LEVEL PROC
    MOV DL,15
    MOV DH,1
    MOV AH,02
    INT 10H
    LEA DX,LV
    MOV AH,09
    INT 21H
    MOV DL,20
    MOV DH,1
    MOV AH,02
    INT 10H
    MOV BL,0CH;RED
    MOV AH,0EH
    MOV AL,'1'
    INT 10H
    RET
SHOW_LEVEL ENDP
;--------------------------------------------------------------------
SHOW_MINSCORE PROC
    MOV DL,25
    MOV DH,1
    MOV AH,02
    INT 10H
    LEA DX,MIN_SCORE
    MOV AH,09H
    INT 21H
    MOV DL,35
    MOV DH,1
    MOV AH,02
    INT 10H
    MOV BL,0CH
    MOV AH,0EH
    MOV AL,'0'
    INT 10H
    MOV AL,'8'
    INT 10H
    MOV AL,'1'
    INT 10H
    RET
SHOW_MINSCORE ENDP
;--------------------------------------------------------------------
CALC_SCORE PROC
    CMP SCORE_2,'9'
    JE TENTH_PLACE
    INC SCORE_2
    JMP LAST
    TENTH_PLACE:
        CMP SCORE_1,'9'
        JE HUNDREDTH_PLACE
        INC SCORE_1
        MOV SCORE_2,'0'
        JMP LAST
    HUNDREDTH_PLACE:
        INC SCORE_0
        MOV SCORE_1,'0'
        MOV SCORE_2,'0'
        JMP LAST
   LAST:
   CALL SHOW_SCORE
   RET
CALC_SCORE ENDP
;--------------------------------------------------------------------
CHECK PROC 
    MOV AH,0DH ;reading pixel
    MOV BH,0 
    INT 10H  
    CMP AL,0DH
    JNE EX 
    MOV BOOL,1 
    EX: 
    RET 
CHECK ENDP
;--------------------------------------------------------------------        
ENDS

END START 
